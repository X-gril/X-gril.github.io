<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8"/> 
  <title>新闻图片轮播</title>
  <base target="_blank" /> 
  <script type="text/javascript" src="http://keleyi.com/keleyi/pmedia/jquery/jquery-1.10.2.min.js"></script>
  
  <script typr="text/javascript">
     $(document).ready(function () {
        var len=$(".newsImg img").length;
        var ix=0;
        var t=true;

        function imageAppear(i){
            $(".newsImg img").eq(i).stop(true,true).fadeIn(1000).siblings("img").hide();
            $(".newsIx li").removeClass("newsIxHover");
            $(".newsIx li").eq(i).addClass("newsIxHover");
            $(".newsTp a").eq(i).stop(true,true).fadeIn(1000).siblings("a").hide("slow");
        }
        imageAppear(ix);

        $(".newsIx li").click(function(){ix=$(".newsIx li").index(this);imageAppear(ix);t=false;});

        function autoSwitch(){
            setInterval(function(){if(t){ix=(ix+1)%len;imageAppear(ix);}t=true;},3000);
        }
        autoSwitch();
    });
  </script>
 
  <style type="text/css">
    *{margin:0px;padding: 0px;}
    .newsIxHover{background-color: #A9A9A9;}
    .newsImg{width:700px;height:500px;}
    .newsIx{position:relative;margin-right: 5px;top:-50px;float:right;}
    .newsIx li{list-style-type:none;width:18px;height:16px;line-height:16px;cursor:pointer;margin:0 3px;font-size:12px;font-weight:600;text-align:center;float:left;display:inline;}
    .newsTp{position:relative;padding-left: 10px;top:-25px;height:22px;line-height: 20px;}
    .newsTp a{text-decoration: none;color:white;font-size:12px;background-color: gray;}
    .newsTp a:hover{color:blue;}
    .newsX{width:700px;height:500px;}
  </style>
</head>

<body>
  <div style="width:70%;margin:0 auto;">
    <div class='newsX' style="margin:0 auto;">
        <h4>新闻连连看</h4>
        <div class='newsImg'>
          <img src="" width='100%' height='100%' id='image1'>
          <img src="" width='100%' height='100%' id='image2'>
          <img src="" width='100%' height='100%' id='image3'>
          <img src="" width='100%' height='100%' id='image4'>
        </div>
        <div class='newsIx' style="margin:0 auto;">
          <ul>
            <li class="newsIxHover">1</li>
            <input type="button" value="上一页" id='input1'>
            <li>2</li>
            <li>3</li>
            <li>4</li>
            <input type="button" value="下一页" id='input2'>
          </ul>
        </div>
        <div class='newsTp'>
            <a href="" id='a1'></a> 
            <a href="" style="display:none" id='a2'></a>
            <a href="" style="display:none" id='a3'></a>
            <a href="" style="display:none" id='a4'></a>
        </div>
    </div>
  </div>
  <script>
    void function(){
      var url='news.json';
      var fg=0;

      function processData(data){
        document.querySelector('#image1').setAttribute('src',data['data'][0+fg].image);
        document.querySelector('#image2').setAttribute('src',data['data'][1+fg].image);
        document.querySelector('#image3').setAttribute('src',data['data'][2+fg].image);
        document.querySelector('#image4').setAttribute('src',data['data'][3+fg].image);

        document.querySelector('#a1').setAttribute('href',data['data'][0+fg].news);
        document.querySelector('#a2').setAttribute('href',data['data'][1+fg].news);
        document.querySelector('#a3').setAttribute('href',data['data'][2+fg].news);
        document.querySelector('#a4').setAttribute('href',data['data'][3+fg].news);

        document.querySelector('#a1').innerHTML=data['data'][0+fg].Name;
        document.querySelector('#a2').innerHTML=data['data'][1+fg].Name;
        document.querySelector('#a3').innerHTML=data['data'][2+fg].Name;
        document.querySelector('#a4').innerHTML=data['data'][3+fg].Name;
       
      }

      function handler(){
        if(this.readyState==this.DONE){
          if(this.status==200){
            try{
              processData(JSON.parse(this.responseText));
            }catch(ex){
              console.log(JSON.parse(this.responseText));
              console.log(ex.message);
            }
          }
        }
      }

      function ajax(){
        var client=new XMLHttpRequest();
        client.onreadystatechange=handler;
        client.open('GET',url);
        client.send();
      }
      ajax();

      document.querySelector('#input2').addEventListener('click',function(evt){fg=4;ajax();evt.stopPropagation();});
      document.querySelector('#input1').addEventListener('click',function(evt){fg=0;ajax();evt.stopPropagation();});
    }();
  </script>
</body>
</html>
